import vs

def FindElementByName(name):
	max = vs.g_pDataModel.GetElementsAllocatedSoFar()
	elementHandle = vs.g_pDataModel.FirstAllocatedElement()
	
	for i in range(max):
		element = vs.g_pDataModel.GetElementName(elementHandle)
		if (element.GetName() == name):
			return vs.g_pDataModel.GetElement(elementHandle)
		#end if
		elementHandle = vs.g_pDataModel.NextAllocatedElement(elementHandle)
	#end for
	
	return None
#end

def FindElementByTypeAndName(type, name):
	max = vs.g_pDataModel.GetElementsAllocatedSoFar()
	elementHandle = vs.g_pDataModel.FirstAllocatedElement()
	
	for i in range(max):
		element = vs.g_pDataModel.GetElement(elementHandle)
		if (element.GetName() == name and element.GetTypeString() == type):
			return element
		#end if
		elementHandle = vs.g_pDataModel.NextAllocatedElement(elementHandle)
	#end for
	
	return None
#end

def GetCurrentTimeSelection():
	timeSelection = FindElementByTypeAndName("DmeTimeSelection", "timeSelection")
	
	times = [timeSelection.GetAttribute("falloff_left"),
		timeSelection.GetAttribute("hold_left"),
		timeSelection.GetAttribute("falloff_right"),
		timeSelection.GetAttribute("hold_right")]
	
	return {"falloff_left": times[0].GetValue().GetSeconds(),
			"hold_left": times[1].GetValue().GetSeconds(),
			"falloff_right": times[2].GetValue().GetSeconds(),
			"hold_right": times[3].GetValue().GetSeconds()}
#end

def GetFrameRate():
	renderSettings = FindElementByTypeAndName("DmElement", "renderSettings")
	return renderSettings.GetAttribute("frameRate").GetValue()
#end